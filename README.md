# MyDocker - ç®€åŒ–ç‰ˆDockerå®ç°

è¿™æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„Dockerå®¹å™¨è¿è¡Œæ—¶å®ç°ï¼ŒåŒ…å«Dockerçš„æ ¸å¿ƒåŠŸèƒ½ã€‚

## é¡¹ç›®ç»“æ„

```
docker-impl/
â”œâ”€â”€ cmd/                    # CLIå…¥å£
â”‚   â””â”€â”€ mydocker/         # ä¸»ç¨‹åº
â”œâ”€â”€ pkg/                   # æ ¸å¿ƒåŒ…
â”‚   â”œâ”€â”€ cli/              # CLIå‘½ä»¤å®ç°
â”‚   â”œâ”€â”€ cluster/          # é›†ç¾¤ç®¡ç†
â”‚   â”œâ”€â”€ container/        # å®¹å™¨ç®¡ç†
â”‚   â”œâ”€â”€ image/            # é•œåƒç®¡ç†
â”‚   â”œâ”€â”€ network/          # ç½‘ç»œç®¡ç†
â”‚   â”œâ”€â”€ performance/      # æ€§èƒ½ä¼˜åŒ–
â”‚   â”œâ”€â”€ storage/          # å­˜å‚¨ç®¡ç†
â”‚   â”œâ”€â”€ store/            # å­˜å‚¨ç®¡ç†
â”‚   â””â”€â”€ types/            # æ•°æ®ç±»å‹å®šä¹‰
â”œâ”€â”€ tests/                 # æµ‹è¯•
â”‚   â””â”€â”€ integration/      # é›†æˆæµ‹è¯•
â”œâ”€â”€ go.mod               # Goæ¨¡å—
â””â”€â”€ README.md            # é¡¹ç›®è¯´æ˜
```

## æ ¸å¿ƒåŠŸèƒ½

### é•œåƒç®¡ç†
- `mydocker image pull <image>` - æ‹‰å–é•œåƒ
- `mydocker image list` - åˆ—å‡ºæœ¬åœ°é•œåƒ
- `mydocker image remove <image>` - åˆ é™¤é•œåƒ
- `mydocker image build` - æ„å»ºé•œåƒ
- `mydocker image tag` - é•œåƒæ ‡ç­¾ç®¡ç†

### å®¹å™¨ç®¡ç†
- `mydocker container run <image> <command>` - è¿è¡Œå®¹å™¨
- `mydocker container list` - åˆ—å‡ºå®¹å™¨
- `mydocker container start <container>` - å¯åŠ¨å®¹å™¨
- `mydocker container stop <container>` - åœæ­¢å®¹å™¨
- `mydocker container remove <container>` - åˆ é™¤å®¹å™¨
- `mydocker container logs <container>` - æŸ¥çœ‹æ—¥å¿—
- `mydocker container inspect <container>` - æ£€æŸ¥å®¹å™¨

### ç³»ç»Ÿç®¡ç†
- `mydocker system info` - ç³»ç»Ÿä¿¡æ¯
- `mydocker system prune` - æ¸…ç†æœªä½¿ç”¨çš„æ•°æ®

### é›†ç¾¤ç®¡ç†
- `mydocker cluster init` - åˆå§‹åŒ–é›†ç¾¤
- `mydocker cluster join` - åŠ å…¥ç°æœ‰é›†ç¾¤
- `mydocker cluster leave` - ç¦»å¼€é›†ç¾¤
- `mydocker cluster info` - é›†ç¾¤ä¿¡æ¯
- `mydocker cluster status` - é›†ç¾¤çŠ¶æ€
- `mydocker node ls` - åˆ—å‡ºé›†ç¾¤èŠ‚ç‚¹
- `mydocker task ls` - åˆ—å‡ºé›†ç¾¤ä»»åŠ¡
- `mydocker service ls` - åˆ—å‡ºé›†ç¾¤æœåŠ¡

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¨¡å—
1. **CLIæ¨¡å—** - å‘½ä»¤è¡Œæ¥å£
2. **Daemonæ¨¡å—** - ä¸»è¿›ç¨‹ç®¡ç†
3. **é•œåƒç®¡ç†æ¨¡å—** - é•œåƒå­˜å‚¨å’Œç®¡ç†
4. **å®¹å™¨ç®¡ç†æ¨¡å—** - å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
5. **å­˜å‚¨æ¨¡å—** - åˆ†å±‚æ–‡ä»¶ç³»ç»Ÿ
6. **ç½‘ç»œæ¨¡å—** - ç½‘ç»œé…ç½®
7. **æ€§èƒ½ä¼˜åŒ–æ¨¡å—** - æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–
8. **é›†ç¾¤ç®¡ç†æ¨¡å—** - å¤šèŠ‚ç‚¹é›†ç¾¤ç®¡ç†

### éš”ç¦»æœºåˆ¶
- **å‘½åç©ºé—´éš”ç¦»** - PIDã€ç½‘ç»œã€æŒ‚è½½ã€UTSã€IPC
- **èµ„æºé™åˆ¶** - cgroupså®ç°CPUã€å†…å­˜é™åˆ¶
- **æ–‡ä»¶ç³»ç»Ÿ** - Union File System

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Go 1.21+
- **å®¹å™¨æŠ€æœ¯**: Linux namespaces, cgroups
- **å­˜å‚¨**: Union File System, Overlayæ–‡ä»¶ç³»ç»Ÿ
- **ç½‘ç»œ**: ç½‘æ¡¥æ¨¡å¼, DNSæœåŠ¡å‘ç°
- **æ€§èƒ½**: Prometheusç›‘æ§, LRUç¼“å­˜, å·¥ä½œæ± 
- **é›†ç¾¤**: RESTful API, å¥åº·æ£€æŸ¥, ä»»åŠ¡è°ƒåº¦
- **æµ‹è¯•**: Go testing framework + testify

## æ„å»ºå’Œè¿è¡Œ

### å‰ææ¡ä»¶
- Go 1.21+
- Linuxç¯å¢ƒï¼ˆæ”¯æŒnamespaceså’Œcgroupsï¼‰

### æ„å»º
```bash
go build -o mydocker ./cmd/mydocker
```

### è¿è¡Œæµ‹è¯•
```bash
# å•å…ƒæµ‹è¯•
go test ./pkg/...

# é›†æˆæµ‹è¯•
go test ./tests/integration/...
```

### ä½¿ç”¨ç¤ºä¾‹
```bash
# æ‹‰å–é•œåƒ
./mydocker image pull alpine

# åˆ—å‡ºé•œåƒ
./mydocker image list

# è¿è¡Œå®¹å™¨
./mydocker container run alpine echo "Hello World"

# åˆ—å‡ºå®¹å™¨
./mydocker container list --all

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
./mydocker container logs <container_id>

# åœæ­¢å®¹å™¨
./mydocker container stop <container_id>

# åˆ é™¤å®¹å™¨
./mydocker container remove <container_id>

# é›†ç¾¤ç®¡ç†
./mydocker cluster init --advertise-addr 192.168.1.100
./mydocker cluster join --advertise-addr 192.168.1.101 --join-token <token>
./mydocker cluster status
./mydocker node ls
./mydocker task ls
```

## è®¾è®¡åŸåˆ™

1. **å°æ­¥å¿«è·‘** - åˆ†é˜¶æ®µå®ç°ï¼Œæ¯é˜¶æ®µéƒ½æœ‰å®Œæ•´çš„æµ‹è¯•
2. **ç®€å•å¯é ** - ä¿æŒä»£ç ç®€æ´ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤
3. **å®‰å…¨ç¬¬ä¸€** - å®ç°åŸºæœ¬çš„éš”ç¦»å’Œå®‰å…¨æœºåˆ¶
4. **å¯æ‰©å±•æ€§** - æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- æ¯ä¸ªæ¨¡å—çš„ç‹¬ç«‹åŠŸèƒ½æµ‹è¯•
- è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯å¤„ç†æµ‹è¯•
- ä½¿ç”¨testifyè¿›è¡Œæ–­è¨€

### é›†æˆæµ‹è¯•
- ç«¯åˆ°ç«¯åŠŸèƒ½æµ‹è¯•
- å®Œæ•´çš„å·¥ä½œæµç¨‹æµ‹è¯•
- é”™è¯¯æ¢å¤å’Œå¹¶å‘æµ‹è¯•

### æ€§èƒ½æµ‹è¯•
- åŸºå‡†æµ‹è¯•
- å¹¶å‘æ€§èƒ½æµ‹è¯•
- èµ„æºä½¿ç”¨æµ‹è¯•

## å¼€å‘çŠ¶æ€

- [x] éœ€æ±‚åˆ†æå’Œè®¾è®¡
- [x] æ ¸å¿ƒåŠŸèƒ½å®ç°
- [x] å•å…ƒæµ‹è¯•
- [x] é›†æˆæµ‹è¯•
- [x] æ€§èƒ½ä¼˜åŒ–
- [x] æ›´å¤šç½‘ç»œåŠŸèƒ½
- [x] å­˜å‚¨é©±åŠ¨ä¼˜åŒ–
- [x] é›†ç¾¤æ”¯æŒ

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¼–å†™æµ‹è¯•
4. æäº¤å˜æ›´
5. å‘èµ·Pull Request

## è®¸å¯è¯

MIT License

## ğŸ“š å­¦ä¹ æ–‡æ¡£

ä¸ºå¸®åŠ©åˆå­¦è€…ç†è§£é¡¹ç›®æºç ï¼Œæˆ‘ä»¬å‡†å¤‡äº†è¯¦ç»†çš„å­¦ä¹ æ–‡æ¡£ï¼š

### ğŸš€ å¿«é€Ÿå…¥é—¨
- [ğŸ“– æºç é˜…è¯»æŒ‡å—](docs/SOURCE_CODE_GUIDE.md) - é›¶åŸºç¡€å…¥é—¨ï¼Œæ¨èä»è¿™é‡Œå¼€å§‹
- [ğŸ“Š æ¨¡å—ä¾èµ–å…³ç³»](docs/MODULE_DEPENDENCIES.md) - ä»£ç ç»“æ„å’Œé˜…è¯»é¡ºåºè¯¦è§£
- [ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µè¯¦è§£](docs/CORE_CONCEPTS.md) - å®¹å™¨æŠ€æœ¯åŸç†è§£æ
- [ğŸ’» ä»£ç ç¤ºä¾‹ç»ƒä¹ ](docs/CODE_READING_EXAMPLES.md) - è¾¹å­¦è¾¹ç»ƒçš„å®è·µé¡¹ç›®

### ğŸ“– æ–‡æ¡£ç‰¹è‰²
- **å¾ªåºæ¸è¿›çš„è®¾è®¡**ï¼šä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§å®è·µ
- **è¯¦ç»†çš„ä»£ç åˆ†æ**ï¼šæ¯ä¸ªå…³é”®åŠŸèƒ½éƒ½æœ‰æ·±åº¦è§£æ
- **ä¸°å¯Œçš„å®æˆ˜ç»ƒä¹ **ï¼šé€šè¿‡åŠ¨æ‰‹å®è·µåŠ æ·±ç†è§£
- **ç”Ÿæ´»ä¸­çš„æ¯”å–»**ï¼šç”¨ç®€å•çš„ä¾‹å­è§£é‡Šå¤æ‚çš„æŠ€æœ¯æ¦‚å¿µ
- **å®Œæ•´çš„å­¦ä¹ è·¯å¾„**ï¼šä»é›¶åŸºç¡€åˆ°ç²¾é€šçš„å®Œæ•´æŒ‡å¯¼

### ğŸ¯ é€‚åˆäººç¾¤
- æƒ³å­¦ä¹ å®¹å™¨æŠ€æœ¯çš„åˆå­¦è€…
- å¸Œæœ›ç†è§£DockeråŸç†çš„å¼€å‘è€…
- éœ€è¦é˜…è¯»Goé¡¹ç›®æºç çš„å·¥ç¨‹å¸ˆ
- å¯¹ç³»ç»Ÿåº•å±‚æŠ€æœ¯æ„Ÿå…´è¶£çš„å­¦ä¹ è€…

## æ³¨æ„äº‹é¡¹

è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ å’Œæ¼”ç¤ºé¡¹ç›®ï¼Œä»…ç”¨äºç†è§£Dockerçš„æ ¸å¿ƒåŸç†ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ä½¿ç”¨å®˜æ–¹çš„Dockeräº§å“ã€‚